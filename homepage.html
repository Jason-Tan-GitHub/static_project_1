<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Internship Question</title>
        <link rel="stylesheet" href="homepage.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/parallax/3.1.0/parallax.min.js"></script>
    </head>
    <body>
        <header class="topNav">
            <h3 class="semibold">LOGO</h3>
            <div class="right">
                <button>Demo</button>
                <button>Login</button>
                <button>Sign up</button>
            </div>
        </header>
        <hr>
        <div class="menu Menu">
            <button>Trading</button>
            <button>Platforms</button>
            <button>Client Tools</button>
            <button>Promotions</button>
            <button>Research</button>
            <button>Partnerships</button>
            <button>About Us</button>
        </div>
        <div class="bannerContainer">
            <div class="banner">
                <div class="santaWrapper">
                    <img id="santa"
                        src="assets/santa.png" />
                    <div class="sparkles">
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                </div>
                <div id="scene">
                    <!-- Background -->
                    <div class="background" data-depth="0.2">
                        <img id="background-left"
                            src="assets/background.webp" />
                    </div>
                    <div class="mountain" data-depth="0.6">
                        <img
                            src="assets/mountain.png" />
                    </div>
                </div>
                <div class="bannerText">
                    <p>Celebrate with Us</p>
                    <h1 class="title"><span class="aqua">Merry
                        </span>Christmas&#58;</h1>
                    <h2>Let the of <span class="aqua">sparkle</span> the <br>
                        holidays light up your days.</h2>
                    <div class="promo-line">
                        <span>CHECK OUR PROMOTIONS</span>
                    </div>
                </div>
            </div>
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                  var scene = document.getElementById("scene");
                  var parallaxInstance = new Parallax(scene, { relativeInput: true });
                });
            </script>
        </div>
        <div class="content">
            <div class="brands">
                <img src="assets/brands/brands_HSBC.png" alt="HSBC">
                <img src="assets/brands/brands_UBS.png" alt="UBS">
                <img src="assets/brands/brands_CITI.png" alt="CITI">
                <img src="assets/brands/brands_BOA.png" alt="BOA">
                <img src="assets/brands/brands_CME.png" alt="CME">
                <img src="assets/brands/brands_DB.png" alt="DB">
                <img src="assets/brands/brands_JP.png" alt="JP">
            </div>
            <div class="popularInstruments">
                <div class="popularContainer">
                    <h3 class="red">Access To The Most</h3>
                    <h1>POPULAR INSTRUMENTS</h1>
                </div>
                <div class="instrument">
                    <div class="left">
                        <div class="instruments">
                            <div>
                                <img src="assets/icon/forex.png" alt="FOREX">
                            </div>
                            <div>
                                <h3>Forex</h3>
                                <p>Trade over 100 currency pairs, including the
                                    majors, minors and exotics, with ultra-low
                                    spreads and fast execution.</p>
                            </div>
                        </div>
                        <div class="instruments">
                            <div>
                                <img src="assets/icon/stock.png" alt="STOCK">
                            </div>
                            <div>
                                <h3>Stocks</h3>
                                <p>Get access to major international stocks
                                    (Apple, Google, Tesla) with no commissions
                                    or requotes and no hidden mark-ups.</p>
                            </div>
                        </div>
                        <div class="instruments">
                            <div>
                                <img src="assets/icon/indices.png"
                                    alt="INDICES">
                            </div>
                            <div>
                                <h3>Stock Indices</h3>
                                <p>Get access to major international stocks
                                    (Apple, Google, Tesla) with no commissions
                                    or requotes and no hidden mark-ups.</p>
                            </div>
                        </div>
                        <div class="instruments">
                            <div>
                                <img src="assets/icon/wheat.png" alt="WHEAT">
                            </div>
                            <div>
                                <h3>Commodities</h3>
                                <p>Trade over a vast variety of commodities
                                    (Cotton, Cocoa, Wheat) with ultra-low
                                    spreads and fast execution.</p>
                            </div>
                        </div>
                    </div>
                    <div class="right">
                        <div class="instruments">
                            <div>
                                <img src="assets/icon/gold.png" alt="GOLD">
                            </div>
                            <div>
                                <h3>Precious Metals</h3>
                                <p>Speculate on the price movements of Gold and
                                    Silver against the US Dollar and diversify
                                    your trading portfolio.</p>
                            </div>
                        </div>
                        <div class="instruments">
                            <div>
                                <img src="assets/icon/energy.png"
                                    alt="ENERGY">
                            </div>
                            <div>
                                <h3>Energies</h3>
                                <p>Trade CFDs on spot energies such as Brent oil
                                    and natural gas with no commissions or
                                    requotes and no hidden mark-ups.</p>
                            </div>
                        </div>
                        <div class="instruments">
                            <div>
                                <img src="assets/icon/crypto.png"
                                    alt="CRYPTO">
                            </div>
                            <div>
                                <h3>Cryptocurrency</h3>
                                <p>Trade the new era of currencies such as
                                    Bitcoin, Etherium and Litecoin with
                                    ultra-low spreads and fast execution.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="brandIntro">
                <div class="brandDisplay">
                    <div class="bIleft">
                        <img src="assets/bull.png" alt="Bull">
                    </div>
                    <div class="bIright">
                        <img src="assets/bear.png" alt="Bear">
                    </div>
                </div>
                <div class="bIouter">
                    <div class="bIcontainer">
                        <div class="left">
                            <div>
                                <h1 class="red">Brand Introduce</h2>
                                <h1>100% Stocks & <br>
                                    0% Commission</h1>
                                <p>Get exactly what you're paying for the
                                    commission-free stock investing</p>
                            </div>
                            <div><button>Explore</button></div>
                        </div>
                        <div class="right">
                            <div class="infoBox pushed">
                                <h3 class="bold">The Perfect Environment For
                                    Expert Advisors(EA)</h2>
                                <p>We've built the perfect environment for EAs
                                    to thrive - we allow scalping, hedging, news
                                    trading and more. No requotes and no minimum
                                    stop loss distance.</p>
                            </div>
                            <div class="infoBox">
                                <h3 class=" bold">Instant Deposits. <br> Fast
                                    Withdrawals.</h3>
                                <p>Fund your account easily and security through
                                    our wide range of payment options. Your
                                    funds are held security in Tier 1 banks.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="instrumentTable">
                <div class="iTcontainer">
                    <div class="iTleft">
                        <div class="iTleftContainer">
                            <h1 class="tagline red">Make Your Move</h1>
                            <h1 class="bold">Trade Over 5600 <br>
                                Global Markets.</h1>
                            <p class="semibold">We Offer Two Levels of Pricing
                                Depending On Your
                                Account
                                Tier.</p>
                            <form class="formSearch">
                                <input type="text" placeholder="Search Market"
                                    id="searchInput" onkeyup="filterTable()">
                                <span class="separate"></span>
                                <i class="fa fa-search"></i>
                            </form>
                            <script>
                                document.querySelector(".formSearch").addEventListener("submit", function (event) {
                                    event.preventDefault(); // Prevents page reload on "Enter"
                                  });                                  
                            </script>
                            <div class="gridInfo">
                                <div class="gridInfoBox">
                                    <div>
                                        <h4 class="semibold">$100</h4>
                                        <p>Minimum Deposit</p>
                                    </div>
                                    <div>
                                        <h4 class="semibold">1:500</h4>
                                        <p>Max Leverage</p>
                                    </div>
                                    <div>
                                        <h4 class="semibold">10000+</h4>
                                        <p>Trading Instruments</p>
                                    </div>
                                </div>
                                <div class="gridInfoBox">
                                    <div>
                                        <h4 class="semibold">100%</h4>
                                        <p>Security of Funds</p>
                                    </div>
                                    <div>
                                        <h4 class="semibold">10+</h4>
                                        <p>Funding Options</p>
                                    </div>
                                    <div>
                                        <h4 class="semibold">&lt;20ms</h4>
                                        <p>Execution Speed</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="iTright">
                        <table id="tableIn">
                            <thead>
                                <tr>
                                    <th>Symbol</th>
                                    <th>Bid</th>
                                    <th>Ask</th>
                                    <th>DailyChange</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                        <div id="pagination"></div>
                        <div id="error-message" style="color: red;"></div>
                    </div>
                </div>
            </div>
            <div class="invBox">
                <div class="invDecide">
                    <div class="invContainer">
                        <div class="iDleft">
                            <div class="iDleftContainer">
                                <h1 class="red tagline">Make Your Move</h1>
                                <h2 class="bold">Make Smart Investment <br>
                                    Decisions With Brand</h2>
                                <p>Daily Market Reviews &#8594;</p>
                                <p>Exclusive Trading Tools &#8594;</p>
                                <p>Technical Analysis From Central &#8594;</p>
                                <p>Economic Data Earnings Calendar &#8594;</p>
                            </div>
                        </div>
                        <div class="iDright">
                            <img src="assets/mobile-phone.png" alt>
                        </div>
                    </div>
                </div>
            </div>
            <div class="getStarted">
                <div class="gScontainer">
                    <div class="gSinner">
                        <div class="gSleft">
                            <h1 class="tagline red">How To Get Started</h1>
                            <h2 class="bold">Start Free In 4 Steps</h2>
                            <img src="assets/images-3.png" alt>
                        </div>
                        <div class="gSright">
                            <div class="left">
                                <h3>1</h3>
                                <h3>2</h3>
                                <h3>3</h3>
                                <h3>4</h3>
                            </div>
                            <div class="right">
                                <div>
                                    <p class="bold">Register</p>
                                    <p>Open an account filling in your
                                        details.</p>
                                </div>
                                <div>
                                    <p class="bold">Verify</p>
                                    <p>Upload your document(s) for fast
                                        verification.</p>
                                </div>
                                <div>
                                    <p class="bold">Fund</p>
                                    <p>Fund your account with your chosen
                                        payment
                                        method.</p>
                                </div>
                                <div>
                                    <p class="bold">Trade</p>
                                    <p>Unlock thousands of instruments and start
                                        investing.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <footer>
                <div class="footerTop">
                    <div class="left">
                        <i class="fa fa-globe" style="font-size:24px"></i>
                        <p>English (Malaysia)</p>
                    </div>
                    <div class="right">
                        <i class="fa fa-facebook"
                            style="font-size:24px"></i>
                        <i class="fa fa-instagram"
                            style="font-size:24px"></i>
                        <i class="fa fa-twitter" style="font-size:24px"></i>
                        <i class="fa fa-youtube-play"
                            style="font-size:24px"></i>
                        <i class="fa fa-linkedin"
                            style="font-size:24px"></i>
                    </div>
                </div>
                <p>Lorem Ipsum is simply dummy text of the printing and
                    typesetting industry. Lorem Ipsum has been the
                    industry's
                    standard dummy text ever since the 1500s, when an
                    unknown
                    printer took a galley of type and scrambled it to make a
                    type specimen book. It has survived not only five
                    centuries,
                    but also the leap into electronic typesetting, remaining
                    essentially unchanged. It was popularised in the 1960s
                    with
                    the release of Letraset sheets containing Lorem Ipsum
                    passages, and more recently with desktop publishing
                    software
                    like Aldus PageMaker including versions of Lorem
                    Ipsum.</p>
                <p>Lorem Ipsum is simply dummy text of the printing and
                    typesetting industry. Lorem Ipsum has been the
                    industry's
                    standard dummy text ever since the 1500s, when an
                    unknown
                    printer took a galley of type and scrambled it to make a
                    type specimen book. It has survived not only five
                    centuries,
                    but also the leap into electronic typesetting, remaining
                    essentially unchanged.</p>
                <p>Lorem Ipsum is simply dummy text of the printing and
                    typesetting industry. Lorem Ipsum has been the
                    industry's
                    standard dummy text ever since the 1500s, when an
                    unknown
                    printer took a galley of type and scrambled it to make a
                    type specimen book. It has survived not only five
                    centuries,
                    but also the leap into electronic typesetting, remaining
                    essentially unchanged. It was popularised in the 1960s
                    with
                    the release of Letraset sheets containing Lorem Ipsum
                    passages, and more recently with desktop publishing
                    software
                    like Aldus PageMaker including versions of Lorem
                    Ipsum.</p>
            </footer>
        </div>
        <script>  
            const apiUrl = "http://18.143.79.95/api/priceData/technical-test";
            const rowsPerPage = 8;
            let currentPage = 1;
            let fetchedData = [];
            let filteredData = [];
            let previousPrices = {};
            
            document.addEventListener("DOMContentLoaded", () => {
                fetchData();
                setInterval(fetchData, 3000);
                document.getElementById("searchInput").addEventListener("input", filterTable);
            });
            
            function fetchData() {
                fetch(apiUrl)
                    .then(response => {
                        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                        return response.json();
                    })
                    .then(data => {
                        if (!Array.isArray(data)) return;
                        data.sort((a, b) => a.Symbol.localeCompare(b.Symbol));
            
                        if (fetchedData.length === 0) {
                            fetchedData = data;
                            filteredData = [...fetchedData];
                            renderTable();
                            setupPagination();
                        } else {
                            updatePrices(data);
                        }
                    })
                    .catch(error => {
                        document.getElementById("error-message").textContent = "Error fetching data: " + error.message;
                    });
            }
            
            function renderTable() {
                const tableBody = document.querySelector("#tableIn tbody");
                tableBody.innerHTML = "";
            
                const start = (currentPage - 1) * rowsPerPage;
                const end = start + rowsPerPage;
                const paginatedData = filteredData.slice(start, end);
            
                paginatedData.forEach(item => {
                    let row = document.createElement("tr");
                    row.setAttribute("data-symbol", item.Symbol);
            
                    const symbolCell = document.createElement("td");
                    symbolCell.textContent = item.Symbol;
                    symbolCell.style.fontWeight = "bold";
                    row.appendChild(symbolCell);
            
                    ["Bid", "Ask", "DailyChange"].forEach(key => {
                        const cell = document.createElement("td");
                        cell.setAttribute("data-key", key);
                        let value = parseFloat(item[key]);
            
                        if (isNaN(value)) {
                            cell.textContent = "N/A";
                        } else {
                            value = value.toFixed(2);
                            cell.textContent = value;
            
                            if (!previousPrices[item.Symbol]) previousPrices[item.Symbol] = {};
                            previousPrices[item.Symbol][key] = value;
                        }
            
                        row.appendChild(cell);
                    });
            
                    tableBody.appendChild(row);
                });
            }
            
            function updatePrices(newData) {
                newData.forEach(item => {
                    const row = document.querySelector(`tr[data-symbol="${item.Symbol}"]`);
                    if (row) {
                        ["Bid", "Ask", "DailyChange"].forEach(key => {
                            const cell = row.querySelector(`td[data-key="${key}"]`);
                            if (cell) {
                                let newValue = parseFloat(item[key]);
                                if (!isNaN(newValue)) {
                                    newValue = newValue.toFixed(2);
                                    const prevValue = previousPrices[item.Symbol]?.[key] || newValue;
            
                                    if (key === "DailyChange") {
                                        cell.style.color = newValue < 0 ? "red" : newValue > 0 ? "green" : "black";
                                    } else {
                                        cell.style.color = newValue > prevValue ? "red" : newValue < prevValue ? "green" : "black";
                                    }
            
                                    cell.textContent = newValue;
                                    previousPrices[item.Symbol][key] = newValue;
                                }
                            }
                        });
                    }
                });
            }
            
            function setupPagination() {
                const paginationDiv = document.getElementById("pagination");
                paginationDiv.innerHTML = "";
                const totalPages = Math.ceil(filteredData.length / rowsPerPage);
            
                if (totalPages <= 1) return;
            
                function createButton(page) {
                    const button = document.createElement("button");
                    button.textContent = page;
                    button.classList.add("page-btn");
                    if (page === currentPage) button.classList.add("active");
            
                    button.addEventListener("click", () => {
                        currentPage = page;
                        renderTable();
                        setupPagination();
                    });
            
                    return button;
                }
            
                paginationDiv.appendChild(createButton(1));
            
                if (currentPage > 4) {
                    paginationDiv.appendChild(document.createTextNode(" ... "));
                }
            
                let startPage = Math.max(2, currentPage - 3);
                let endPage = Math.min(totalPages - 1, currentPage + 3);
            
                for (let i = startPage; i <= endPage; i++) {
                    paginationDiv.appendChild(createButton(i));
                }
            
                if (currentPage < totalPages - 3) {
                    paginationDiv.appendChild(document.createTextNode(" ... "));
                }
            
                paginationDiv.appendChild(createButton(totalPages));
            }
            
            function filterTable() {
                const searchTerm = document.getElementById("searchInput").value.trim().toLowerCase();
                filteredData = fetchedData.filter(item =>
                    item.Symbol.toLowerCase().includes(searchTerm)
                );
                currentPage = 1;
                renderTable();
                setupPagination();
            }
                                                 
        </script>
    </body>
</html>